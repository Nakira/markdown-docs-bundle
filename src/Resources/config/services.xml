<?xml version="1.0" encoding="UTF-8" ?>
<container xmlns="http://symfony.com/schema/dic/services"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="http://symfony.com/schema/dic/services
        https://symfony.com/schema/dic/services/services-1.0.xsd">
    <services>
        <defaults autowire="false" autoconfigure="true" public="true"/>

        <!-- Main -->

        <service id="mobizel.markdown_docs.markdown_extra" class="Mobizel\Bundle\MarkdownDocsBundle\Markdown\MarkdownExtra"/>

        <service id="mobizel_markdown_docs.template.template_handler" class="Mobizel\Bundle\MarkdownDocsBundle\Template\TemplateHandler">
            <argument key="$docsDir">%mobizel.markdown_docs.docs_dir%</argument>
        </service>
        <service id="Mobizel\Bundle\MarkdownDocsBundle\Template\TemplateHandlerInterface" alias="mobizel_markdown_docs.template.template_handler"/>

        <service id="mobizel_markdown_docs.helper.page_helper" class="Mobizel\Bundle\MarkdownDocsBundle\Helper\PageHelper">
            <argument key="$pagesMap" type="expression">service('mobizel_markdown_docs.data_provider.page_collection').getPagesMap()</argument>
        </service>

        <!-- Data Providers -->

        <service id="mobizel_markdown_docs.data_provider.page_collection" class="Mobizel\Bundle\MarkdownDocsBundle\DataProvider\PageCollectionDataProvider">
            <argument key="$docsDir">%mobizel.markdown_docs.docs_dir%</argument>
        </service>
        <service id="Mobizel\Bundle\MarkdownDocsBundle\DataProvider\PageCollectionDataProviderInterface" alias="mobizel_markdown_docs.data_provider.page_collection"/>

        <service id="mobizel_markdown_docs.data_provider.page_item" class="Mobizel\Bundle\MarkdownDocsBundle\DataProvider\PageItemDataProvider">
            <argument key="$templateHandler" type="service" id="mobizel_markdown_docs.template.template_handler"/>
        </service>
        <service id="Mobizel\Bundle\MarkdownDocsBundle\DataProvider\PageItemDataProviderInterface" alias="mobizel_markdown_docs.data_provider.page_item"/>

        <!-- Twig extensions -->

        <service id="mobizel_markdown_docs.twig.extension.page_title" class="Mobizel\Bundle\MarkdownDocsBundle\Twig\Extension\PageTitleExtension">
            <argument key="$pageHelper" type="service" id="mobizel_markdown_docs.helper.page_helper"/>
        </service>
        <service id="Mobizel\Bundle\MarkdownDocsBundle\Twig\Extension\PageTitleExtensionInterface" alias="mobizel_markdown_docs.twig.extension.page_title"/>

        <service id="mobizel_markdown_docs.twig.extension.pagination" class="Mobizel\Bundle\MarkdownDocsBundle\Twig\Extension\PaginationExtension">
            <argument key="$pageHelper" type="service" id="mobizel_markdown_docs.helper.page_helper"/>
        </service>
        <service id="Mobizel\Bundle\MarkdownDocsBundle\Twig\Extension\PaginationExtensionInterface" alias="mobizel_markdown_docs.twig.extension.pagination"/>

        <!-- Controllers -->

        <service id="mobizel_markdown_docs.controller.index_action" class="Mobizel\Bundle\MarkdownDocsBundle\Controller\IndexAction">
            <call method="setContainer">
                <argument type="service" id="Psr\Container\ContainerInterface"/>
            </call>
            <tag name="container.service_subscriber"/>
        </service>

        <service id="mobizel_markdown_docs.controller.search_action" class="Mobizel\Bundle\MarkdownDocsBundle\Controller\SearchAction">
            <call method="setContainer">
                <argument type="service" id="Psr\Container\ContainerInterface"/>
            </call>
            <tag name="container.service_subscriber"/>
            <argument key="$docsDir">%mobizel.markdown_docs.docs_dir%</argument>
        </service>

        <service id="mobizel_markdown_docs.controller.page_action" class="Mobizel\Bundle\MarkdownDocsBundle\Controller\PageAction">
            <call method="setContainer">
                <argument type="service" id="Psr\Container\ContainerInterface"/>
            </call>
            <tag name="container.service_subscriber"/>
            <argument key="$pageItemDataProvider" type="service" id="mobizel_markdown_docs.data_provider.page_item"/>
        </service>

        <service id="mobizel_markdown_docs.controller.menu_action" class="Mobizel\Bundle\MarkdownDocsBundle\Controller\MenuAction">
            <call method="setContainer">
                <argument type="service" id="Psr\Container\ContainerInterface"/>
            </call>
            <tag name="container.service_subscriber"/>
            <argument key="$pageCollectionDataProvider" type="service" id="mobizel_markdown_docs.data_provider.page_collection"/>
        </service>
    </services>
</container>
